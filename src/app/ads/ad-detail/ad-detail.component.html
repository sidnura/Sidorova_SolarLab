<main>
    <div class="container">
        <div *ngIf="isLoading" class="loading-state">
            <div class="spinner"></div>
            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏—è...</p>
        </div>

        <div *ngIf="errorMessage && !isLoading" class="error-state">
            <p>‚ùå {{ errorMessage }}</p>
        </div>

        <div *ngIf="!advertisement && !isLoading" class="not-found-state">
            –û–±—ä—è–≤–ª–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ! ID: {{ getAdId() }}
        </div>

        <div *ngIf="advertisement && !isLoading" class="ad-container">
            
            <div class="ad-actions" *ngIf="isOwner">
                <button class="btn-edit" (click)="onEdit()" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ">
                    –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
                </button>
            </div>

            <div class="ad-header">
                <h1 class="ad-title">{{ advertisement.name }}</h1>
                <p class="ad-price">{{ advertisement.cost | number }} ‚ÇΩ</p>
            </div>

            <div class="ad-content">
                <div class="ad-image-section">
                    <div class="ad-image">
                        <div *ngIf="hasAdvertisementImage && currentImageUrl; else noPhotoTemplate">
                            <img [src]="currentImageUrl" 
                                 [alt]="advertisement.name" 
                                 (error)="onImageError($event)"
                                 class="ad-image__img">
                            
                            <div *ngIf="hasMultipleImages()" class="image-navigation">
                                <button class="nav-btn prev-btn" (click)="prevImage()">‚Äπ</button>
                                <span class="image-counter">{{ currentImageIndex + 1 }} / {{ allImageUrls.length }}</span>
                                <button class="nav-btn next-btn" (click)="nextImage()">‚Ä∫</button>
                            </div>
                        </div>
                        <ng-template #noPhotoTemplate>
                            <div class="no-image-placeholder">
                                <div class="placeholder-content">
                                    <span class="placeholder-icon">üì∑</span>
                                    <span class="placeholder-text">–ù–µ—Ç —Ñ–æ—Ç–æ</span>
                                </div>
                            </div>
                        </ng-template>
                    </div>
                </div>

                <div class="ad-info-section">
                    <div class="ad-details">
                        <div class="ad-contact-section">
                            <button class="phone-toggle" (click)="togglePhone()">
                                {{ showPhone ? getPhoneNumber() : '–ü–æ–∫–∞–∑–∞—Ç—å –Ω–æ–º–µ—Ä' }}
                            </button>
                            
                            <div class="address-section">
                                <h3 class="section-title">–ê–¥—Ä–µ—Å</h3>
                                <p class="address-text">{{ advertisement.location }}</p>
                                <a href="#" class="map-link">–æ—Ç–∫—Ä—ã—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ</a>
                            </div>
                        </div>

                        <div class="description-section">
                            <h3 class="section-title">–û–ø–∏—Å–∞–Ω–∏–µ</h3>
                            <div class="description-text">
                                <p>{{ advertisement.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç' }}</p>
                                
                                <div *ngIf="advertisement.email">
                                    <p><strong>Email:</strong> {{ advertisement.email }}</p>
                                </div>
                                <p><strong>–°—Ç–∞—Ç—É—Å:</strong> {{ advertisement.isActive ? '–ê–∫—Ç–∏–≤–Ω–æ' : '–ù–µ –∞–∫—Ç–∏–≤–Ω–æ' }}</p>
                                
                                <div *ngIf="advertisement.category">
                                    <p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> {{ advertisement.category.name }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="comments-section-wrapper">
                <app-comments [adId]="advertisement.id"></app-comments>
            </div>
        </div>
    </div>
</main>