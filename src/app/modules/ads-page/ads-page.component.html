<section class="recommendations">
  <div class="container">
    <div class="recommendations-header">
      <h2 class="recommendations__title">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –≤–∞—Å</h2>

      <!-- –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–∞—Ö) -->
      @if (hasActiveFilters()) {
        <button class="reset-filters-btn" (click)="resetAllFilters()">
          ‚úï –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
        </button>
      }
    </div>
  </div>
</section>

<div class="main__container container">
  @if (loading$ | async; as loadingState) {
    @if (loadingState['list']) {
      <div class="loading-state">
        <div class="spinner"></div>
        <p>–ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π...</p>
      </div>
    }
  }

  <ul class="ads">
    @for (ad of adList$ | async; track ad.id) {
      <li class="ads__item" (click)="onClick(ad)">

        <!-- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
        @if (isLoggedIn) {
          <button
            class="delete-btn"
            (click)="deleteAd(ad.id, $event)"
            title="–£–¥–∞–ª–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ">
            üóëÔ∏è
          </button>
        }

        <div class="ads__image-container">
          @if (ad.imagesIds && ad.imagesIds.length > 0) {
            <app-hexagon-image
              [imageId]="ad.imagesIds[0]">
            </app-hexagon-image>
          } @else {
            <div class="no-image-placeholder">
              <div class="placeholder-content">
                <span class="placeholder-icon">üì∑</span>
                <span class="placeholder-text">–ù–µ—Ç —Ñ–æ—Ç–æ</span>
              </div>
            </div>
          }
        </div>

        <div class="ads__content">
          <h3 class="ads__title">{{ ad.name }}</h3>
          <p class="ads__price">{{ ad.cost | number }} ‚ÇΩ</p>
          <p class="ads__description">{{ ad.location }} {{ ad.createdAt }}</p>
        </div>
      </li>
    }
  </ul>

  <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –∫–æ–≥–¥–∞ –Ω–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π -->
  @if (!isLoading) {
    @if (apiAdvertisements.length === 0) {
      <div class="empty-state">
        <h2>–û–±—ä—è–≤–ª–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!</h2>

        @if (hasActiveFilters()) {
          <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ –∏–ª–∏ —Å–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</p>
        } @else {
          <p>–ü–æ–∫–∞ –Ω–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>
        }

        <button class="btn-primary" routerLink="/add-ad">–î–æ–±–∞–≤–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</button>

        <!-- –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ –ø—É—Å—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ -->
        @if (hasActiveFilters()) {
          <button class="btn-secondary" (click)="resetAllFilters()">
            –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
          </button>
        }
      </div>
    }
  }
</div>
